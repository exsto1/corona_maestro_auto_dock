# Workflow maestro_auto_dock 

### README WIP

Workflow to automate calculating RMSD values between ligands in crystal structures and docked protein-ligand complexes in Glide and Vina.   
In order to calculate RMSD values, the .cmd file generated by scripts must be opened in Schrodinger Maestro (in the Command Script Editor panel).       
 
## Requirements
### Linux
Sudo user is recommended, but not necessary. More information in the Schrodinger section below.

### Python 3
%-strings are used, so even older versions of Python (before 3.5) should be supported.    
Only standard libraries are used, no special requirements (at least for now).

#### Test
To test if there is a working python3 distribution on machine user can type in terminal:     
``` python ```    
User should see python version in the output.


### Schrödinger
Working Schrödinger is absolutely necessary, even when using a Vina wrapper. It is recommended to install it locally, so later no sudo permissions will be needed.

#### Test
To test if there is a working schrodinger distribution on machine user can type in terminal:     
``` PATH/TO/SCHRODINGER/maestro ```


## Global variables
To improve performance, global variables are introduced. 
They work like normal flags, however user have to provide them only the first time using a script. 
They can be later changed, editing the scripts/CONFIGURE.txt file or using flag --update.

### List of global variables

Description | Variable type / options | Default value
------------|-------------------------|---------------
PATH to schrodinger | string: PATH | None
Sudo permission | boolean: T / F | T


#### Note about PATH to schrodinger

User should provide a path to the main schrodinger folder. Wrappers are using Maestro scripts, so correct path is absolutely necessary.
In case of any errors, user can modify scripts/CONFIGURE.txt file or use any of the wrappers with -u (--update) flag


## Maestro wrapper - maestro_workflow.py    

### Input files
Docking file: Docking with Glide creates a folder with a proper name in the working directory. Among several files a Pose Viewer file should be generated (_pv.maegz).        

Crystal structures file is generated by importing .pdb files into Maestro panel and exporting structures into one .mae file.    

### Flags description


Flag | Full Flag | Description | Default value
-----|-----------|-------------|------------------
-d | --docking | input file from docking, unzipped *_pv.maegz | -
-c | --crystal | input file with crystals | -
-o | --output | output filename | maestro_script.cmd
-r | --remove | clear created temp files and folders after finished run | False
-u | --update | update gloabal variables | False


## Vina wrapper - vina_workflow.py

#### Input files

Ligand files: After docking with Vina the best poses are generated in the form of a merged .pdbqt file, which should be split into separate files. The file with the best pose according to the scoring function must be converted to the .pdb format using ADTools or proper commands.    

Protein structure file: A .pdbqt file which was used for docking should be converted to .pdb using ADTools or proper command  

Crystal structures file is generated by importing .pdb files into Maestro panel and exporting structures into one .mae file.        



### Flags description

Flag | Full Flag | Description | Default value
-----|-----------|-------------|------------------
-p | --protein | input file with protein structure .pdb | -
-c | --crystal | input file with crystal | -
-l | --ligand | path to folder with ligands .pdb | -
-fr | --fromaa | position from which residues will be removed | -1
-to | --toaa | position to which residues will be removed | -1
-o | --output | output file name | vina_maestro_script.cmd
-r | --remove | clear created temp files and folders after finished run | False
-u | --update | update gloabal variables | False
-s | --save | save workspace folder | -


## Additional scripts - WIP (not important for now)

### file_separate.py
### SMARTS_extract.py
### utils.py
### configuration_scripts.py


## Examples - WIP
Maestro wrapper:    
```python3 maestro_workflow -p -c -l -r```

Vina wrapper:    
```python3 vina_workflow -p -c -l -r```
